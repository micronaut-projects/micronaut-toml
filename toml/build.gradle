plugins {
    id "io.micronaut.build.internal.module"
    id "org.jetbrains.grammarkit" version "2021.2"
}

group = 'io.micronaut.toml'

task generateLexer(type: org.jetbrains.grammarkit.tasks.GenerateLexer) {
    source = 'src/main/jflex/toml.jflex'
    //skeleton = 'src/main/jflex/skeleton-toml'
    targetDir = 'build/generated/sources/jflex/io/micronaut/toml'
    targetClass = 'Lexer'
    purgeOldFiles = true
}

sourceSets.main.java.srcDirs += ['build/generated/sources/jflex']

compileJava {
    dependsOn generateLexer
}

dependencies {
    api mn.micronaut.json.core
    testImplementation mn.micronaut.jackson.databind
    testImplementation mn.micronaut.test.junit5
    testImplementation mn.micronaut.test.spock
    testRuntimeOnly group: 'org.junit.jupiter', name: 'junit-jupiter-engine', version: '5.8.1'
}
